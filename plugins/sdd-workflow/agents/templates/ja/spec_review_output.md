## 仕様書レビュー結果

### 対象ドキュメント

- `{ドキュメントパス}`

### CONSTITUTION.md 準拠チェック

**原則バージョン**: v{X.Y.Z}
**原則ファイル**: `.sdd/CONSTITUTION.md`

| 原則カテゴリ    | 原則ID | 原則名       | 準拠状態                      |
|:------------|:------|:---------|:--------------------------|
| アーキテクチャ原則 | A-001 | {原則名}   | 準拠 / 違反 / 要確認            |
| アーキテクチャ原則 | A-002 | {原則名}   | 準拠 / 違反 / 要確認            |
| 開発方針原則    | D-001 | {原則名}   | 準拠 / 違反 / 要確認            |
| 技術制約      | T-001 | {原則名}   | 準拠 / 違反 / 要確認            |
| ...        | ...   | ...      | ...                       |

### 原則違反（修正提案）

#### 違反 1: {原則ID} - {原則名}

**違反箇所**: {セクション名} / {該当テキスト}

**違反内容**:
{具体的な違反の説明}

**修正提案**:
```markdown
{修正後の記述}
```

**修正優先度**: 高 / 中 / 低

---

### 評価サマリー

| 観点            | 評価                       | コメント    |
|:--------------|:-------------------------|:--------|
| CONSTITUTION 準拠 | 準拠 / 一部違反 / 重大な違反       | {コメント} |
| 完全性           | 良好 / 改善推奨 / 要修正         | {コメント} |
| 明確性           | 良好 / 改善推奨 / 要修正         | {コメント} |
| 一貫性           | 良好 / 改善推奨 / 要修正         | {コメント} |
| SysML 準拠      | 良好 / 改善推奨 / 要修正         | {コメント} |

### 要修正（重大）

#### 1. {問題タイトル}

**場所**: {セクション名} / {行番号}

**問題**:
{具体的な問題の説明}

**改善提案**:

```md
{修正後の記述例}
```

---

### 改善推奨

#### 1. {問題タイトル}

**場所**: {セクション名}

**問題**: {問題の説明}

**改善提案**: {改善の方向性}

---

### 良い点

- {良い点 1}
- {良い点 2}

---

### 不足セクション

以下のセクションを追加する必要があります：

| セクション    | 理由       | 優先度     |
|:---------|:---------|:--------|
| {セクション名} | {追加する理由} | 高 / 中 / 低 |

### トレーサビリティチェック結果

#### PRD - spec トレーサビリティマトリクス（spec ファイルのみ）

| 要件ID     | 要件種別   | PRD 要件内容        | spec マッピング            | ステータス                      |
|:---------|:-------|:----------------|:---------------------|:---------------------------|
| UR-001   | ユーザー要件 | {ユーザー要件内容}      | {対応するユーザーストーリー}       | 🟢 カバー済み / 🟡 部分的カバー       |
| FR-001   | 機能要件   | {機能要件内容}        | {対応する機能要件/API}        | 🟢 カバー済み                   |
| FR-002   | 機能要件   | {機能要件内容}        | 未記載                   | 🔴 未カバー                    |
| NFR-001  | 非機能要件  | {非機能要件内容}       | {対応する制約/品質要件}         | 🟢 カバー済み                   |
| NFR-002  | 非機能要件  | {非機能要件内容}       | 部分的に記載                | 🟡 部分的カバー                  |

**カバレッジ: {X}%（{カバー済み+部分的カバー}/{全要件数}）**

警告: カバレッジが80%未満です（80%未満の場合のみ表示）

**基準**:
- 🟢 **カバー済み**: PRD 要件が spec に明確に記載され、実装方針が定義されている
- 🟡 **部分的カバー**: spec に関連する記述はあるが、要件を完全にカバーしていない
- 🔴 **未カバー**: spec に対応する記述が見つからない

##### 🔴 未カバー要件（{n}件）

###### FR-002: {機能要件タイトル}

**PRD 記述**:
```
{PRD に記載されている要件の詳細}
```

**spec 状態**: 対応する機能要件が未記載

**推奨アクション**:
1. [ ] spec に機能要件を追加し、実装方針を明確化
2. [ ] 必要に応じて API 設計を追加

#### spec - design 整合性（design ファイルのみ）

| spec 要素  | spec 記述               | design マッピング              | ステータス                    |
|:---------|:---------------------|:--------------------------|:-------------------------|
| API 定義   | `{API名}({引数})`       | {詳細な実装方針/シグネチャ}           | 🟢 整合 / 🔴 不整合            |
| データモデル  | `{型名}`               | {詳細な型定義/フィールド仕様}          | 🟢 整合 / 🔴 不整合            |
| 制約      | {制約内容}               | {制約の考慮方法/実装対応}            | 🟢 考慮済み / 🔴 未考慮          |
| 機能要件    | {機能要件内容}             | {実装方針/アーキテクチャ選択}          | 🟢 整合 / 🔴 不整合            |

##### 🔴 不整合項目（{n}件）

###### API 定義の不整合: {API名}

**spec 記述**:
```
{API名}({引数}): {戻り値}
```

**design 記述**:
```
{異なる実装定義}
```

**不整合内容**: {具体的な差異の説明}

**推奨アクション**:
1. [ ] spec と design の定義を統一
2. [ ] 変更の妥当性を検証

#### 整合性チェックサマリー

| チェック対象              | 結果                           | 詳細                                 |
|:--------------------|:-----------------------------|:-----------------------------------|
| PRD - spec          | 🟢 整合 / 🔴 不整合                | カバレッジ: {X}%、未カバー: {n}件             |
| spec - design       | 🟢 整合 / 🔴 不整合                | 不整合: {n}件                          |
| CONSTITUTION - docs | 🟢 準拠 / 🔴 違反 / 原則なし          | 違反: {n}件、一部違反: {n}件                |

### 修正提案サマリー

| 修正対象    | 修正内容    | ステータス     |
|:--------|:--------|:----------|
| {対象 1}  | {内容 1}  | 提案済み      |
| {対象 2}  | {内容 2}  | 要議論       |

### 推奨アクション

1. {アクション 1}
2. {アクション 2}
3. {アクション 3}

---

### 簡略出力（--summary オプション / check-spec から呼び出し時）

### 品質レビュー結果

#### 仕様書品質スコア

| ドキュメント          | CONSTITUTION 準拠                     | 完全性          | 明確性          | SysML 準拠        | 総合評価                            |
|:----------------|:------------------------------------|:-------------|:-------------|:----------------|:--------------------------------|
| `{ファイルパス}`      | 🟢 準拠 / 🟡 一部違反 / 🔴 違反              | 良好 / 改善推奨    | 良好 / 改善推奨    | 良好 / 改善推奨 / -   | 🟢 良好 / 🟡 改善推奨 / 🔴 要修正          |

**注**: design ファイルは SysML 準拠チェックの対象外（`-` 表示）

#### トレーサビリティチェック結果

##### PRD - spec トレーサビリティ（spec ファイルのみ）

| 要件ID     | PRD 要件内容        | spec マッピング            | ステータス                      |
|:---------|:----------------|:---------------------|:---------------------------|
| UR-001   | {ユーザー要件内容}      | {対応するユーザーストーリー}       | 🟢 カバー済み / 🟡 部分的カバー       |
| FR-001   | {機能要件内容}        | {対応する機能要件/API}        | 🟢 カバー済み                   |
| FR-002   | {機能要件内容}        | 未記載                   | 🔴 未カバー                    |
| NFR-001  | {非機能要件内容}       | {対応する制約/品質要件}         | 🟢 カバー済み                   |

**カバレッジ: {X}%（{カバー済み+部分的カバー}/{全要件数}）**

警告: カバレッジが80%未満です（80%未満の場合のみ表示）

##### spec - design 整合性（design ファイルのみ）

| spec 要素  | spec 記述            | design マッピング        | ステータス                    |
|:---------|:-------------------|:--------------------|:-------------------------|
| API 定義   | `{API名}({引数})`     | {詳細な実装方針}           | 🟢 整合 / 🔴 不整合            |
| データモデル  | `{型名}`             | {詳細な型定義}            | 🟢 整合 / 🔴 不整合            |
| 制約      | {制約内容}             | {制約の考慮方法}           | 🟢 考慮済み / 🔴 未考慮          |

#### 検出された問題

##### 🔴 CONSTITUTION.md 違反（{n}件）

- **違反内容**: {プロジェクト原則に違反する内容}
- **場所**: `{ファイル名}` セクション {セクション}
- **推奨修正**: {修正方法}

##### 🟡 完全性の問題（{n}件）

- **不足セクション**: {必要なセクション名}
- **対象ファイル**: `{ファイル名}`
- **推奨アクション**: セクションを追加し、{内容}を記載

##### 🟡 曖昧な記述（{n}件）

- **曖昧な表現**: 「{検出された曖昧な表現}」
- **場所**: `{ファイル名}` セクション {セクション}
- **推奨修正**: {具体的な基準と実装方針を明記}
