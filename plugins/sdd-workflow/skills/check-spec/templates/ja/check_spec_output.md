## 設計書・実装整合性チェック結果

### 対象ドキュメント

- `.sdd/specification/[{親機能名}/]{機能名}_design.md`

※ 階層構造の場合、親機能は `index_design.md`

### チェック結果サマリー

**design ↔ 実装の整合性チェック**:

| チェック対象      | 結果             | 件数    |
|:------------|:---------------|:------|
| design ↔ 実装 | 🟢 整合 / 🔴 不整合 | {n} 件 |

**ドキュメント間整合性・品質レビュー**（`--full` オプション指定時のみ）:

`spec-reviewer` エージェントによる包括的なレビュー結果が以下に表示されます。

| 観点                  | 結果             | 件数    |
|:--------------------|:---------------|:------|
| PRD ↔ spec トレーサビリティ | 🟢 整合 / 🔴 不整合 | {n} 件 |
| spec ↔ design 整合性   | 🟢 整合 / 🔴 不整合 | {n} 件 |
| CONSTITUTION.md 準拠  | 🟢 準拠 / 🔴 違反  | {n} 件 |
| 完全性                 | ✅ 良好 / ⚠️ 要改善  | {n} 件 |
| 明確性                 | ✅ 良好 / ⚠️ 要改善  | {n} 件 |

### 🔴 Critical（即座に対応が必要）

#### 1. {差異のタイトル}

**仕様書の記載**:

```

// *_spec.md より
doSomething(arg: 文字列): Result

```

**実装コード**:

```

// 実装ファイルより
doSomething(arg: 数値): Result // 引数の型が異なる

```

**推奨アクション**:

- [ ] 仕様書を更新する（実装が正しい場合）
- [ ] 実装を修正する（仕様書が正しい場合）

---

### 🟡 Warning（対応推奨）

#### 1. {差異のタイトル}

**内容**: {差異の詳細}

**推奨アクション**: {対応方法}

---

### 🟢 Info（参考情報）

- {情報1}
- {情報2}

---

### 未実装機能

仕様書に記載されているが、実装が確認できなかった機能：

| 機能    | 仕様書の記載箇所              | ステータス  |
|:------|:----------------------|:-------|
| {機能名} | `*_spec.md` の {セクション} | 🔴 未実装 |

### 仕様書に未記載の実装

実装されているが、仕様書に記載がない機能：

| 実装         | ファイル       | 推奨アクション         |
|:-----------|:-----------|:----------------|
| {関数名/クラス名} | `{ファイルパス}` | 仕様書に追記 / 不要なら削除 |

---

### 品質レビュー結果（--fullオプション指定時のみ）

#### 仕様書品質スコア

| ドキュメント                               | CONSTITUTION準拠 | 完全性    | 明確性    | SysML準拠 | 総合評価           |
|:-------------------------------------|:---------------|:-------|:-------|:--------|:---------------|
| `.sdd/specification/{機能名}_spec.md`   | 🟢 準拠 / 🔴 違反  | ✅ / ⚠️ | ✅ / ⚠️ | ✅ / ⚠️  | 🟢 良好 / 🟡 要改善 |
| `.sdd/specification/{機能名}_design.md` | 🟢 準拠 / 🔴 違反  | ✅ / ⚠️ | ✅ / ⚠️ | -       | 🟢 良好 / 🟡 要改善 |

#### 検出された問題

##### 🔴 CONSTITUTION.md 違反（{n}件）

- **違反内容**: {プロジェクト原則に違反している内容}
- **該当箇所**: `{ファイル名}` の {セクション}
- **推奨修正**: {どのように修正すべきか}

##### 🟡 完全性の問題（{n}件）

- **不足セクション**: {必須セクション名}
- **該当ファイル**: `{ファイル名}`
- **推奨アクション**: セクションを追加し、{内容}を記載

##### 🟡 曖昧な記述（{n}件）

- **曖昧な表現**: 「{検出された曖昧な表現}」
- **該当箇所**: `{ファイル名}` の {セクション}
- **推奨修正**: 具体的な基準や実装方針を明記

**注意**: 上記は簡易サマリーです。詳細なレビュー結果（原則違反の詳細、修正提案サマリー等）は、spec-reviewerエージェントから個別に出力されます。

---

### 推奨アクション

#### 優先順位

1. **Critical の差異を優先的に解消**
    - APIシグネチャの不一致（引数、戻り値の型）
    - 設計書に記載された機能の未実装
    - 型定義の不一致

2. **Warning の対応**
    - モジュール構成の整合性確保
    - 設計書に未記載の実装の文書化

3. **Info の確認**
    - 技術スタックの軽微な差異
    - ドキュメント改善の検討

4. **ドキュメント間整合性の確認**（`--full` オプション実行時）
    - spec-reviewer が検出したドキュメント間の不整合を確認
    - PRD ↔ spec ↔ design の整合性を確保

#### 対応フロー

1. design ↔ 実装の不整合を確認し、差異の原因を特定
2. 設計書または実装のどちらを修正するか判断:
    - 実装が正しい場合 → 設計書を更新
    - 設計書が正しい場合 → 実装を修正
3. `--full` オプション実行時は、spec-reviewer の指摘も確認:
    - PRD ↔ spec の不整合
    - spec ↔ design の不整合
    - CONSTITUTION.md 違反
4. 修正後、再度 `/check_spec` を実行して確認
